"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const devkit_1 = require("@nx/devkit");
async function update(tree) {
    const projects = (0, devkit_1.getProjects)(tree);
    projects.forEach((projectConfig, projectName) => {
        let shouldUpdate = false;
        Object.entries(projectConfig.targets).forEach(([targetName, targetConfig]) => {
            if (targetConfig.executor === '@nrwl/esbuild:esbuild') {
                shouldUpdate = true;
                projectConfig.targets[targetName].options ??= {};
                projectConfig.targets[targetName].options.generatePackageJson ??=
                    true;
            }
        });
        if (shouldUpdate) {
            (0, devkit_1.updateProjectConfiguration)(tree, projectName, projectConfig);
        }
    });
    await (0, devkit_1.formatFiles)(tree);
}
exports.default = update;
